(this["webpackJsonpreact-state-building-script"]=this["webpackJsonpreact-state-building-script"]||[]).push([[0],{19:function(e,t,a){e.exports=a(28)},24:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),l=a.n(c);a(24);function u(){return r.a.createElement("footer",null,r.a.createElement("p",null,"This site is created for demonstrative purposes only and does not offer any real products or services."),r.a.createElement("p",null,"\xa9 Pluralsight 2020"))}var i=a(2),o={color:"purple"};function s(){return r.a.createElement("header",null,r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(i.b,{to:"/"},r.a.createElement("img",{alt:"Carved Rock Fitness",src:"/images/logo.png"}))),r.a.createElement("li",null,r.a.createElement(i.c,{activeStyle:o,to:"/shoes"},"Shoes")),r.a.createElement("li",null,r.a.createElement(i.c,{activeStyle:o,to:"/backpacks"},"Backpacks")),r.a.createElement("li",null,r.a.createElement(i.c,{activeStyle:o,to:"/cart"},"Cart")))))}var m=a(3);function d(){return r.a.createElement("div",{className:"lds-container"},r.a.createElement("div",{className:"lds-dual-ring"}))}var E=a(4),p=a.n(E),h=a(7),f=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_BASE_URL;function v(e){var t=Object(n.useRef)(!1),a=Object(n.useState)(null),r=Object(m.a)(a,2),c=r[0],l=r[1],u=Object(n.useState)(null),i=Object(m.a)(u,2),o=i[0],s=i[1],d=Object(n.useState)(!0),E=Object(m.a)(d,2),v=E[0],b=E[1];return Object(n.useEffect)((function(){function a(){return(a=Object(h.a)(p.a.mark((function a(){var n,r;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch(f+e);case 3:if(!(n=a.sent).ok){a.next=11;break}return a.next=7,n.json();case 7:r=a.sent,t.current&&l(r),a.next=12;break;case 11:throw n;case 12:a.next=17;break;case 14:a.prev=14,a.t0=a.catch(0),t.current&&s(a.t0);case 17:return a.prev=17,t.current&&b(!1),a.finish(17);case 20:case"end":return a.stop()}}),a,null,[[0,14,17,20]])})))).apply(this,arguments)}return t.current=!0,function(){a.apply(this,arguments)}(),function(){t.current=!1}}),[e]),{data:c,error:o,loading:v}}function b(e){var t=e.url,a=e.children,n=v(t);return a(n.data,n.loading,n.error)}var y=a(1);function O(){return r.a.createElement("h1",null,"Page not found.")}function g(){var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],c=t[1],l=Object(y.h)().category,u=v("products?category="+l),o=u.data,s=u.loading,E=u.error;var p=a?o.filter((function(e){return e.skus.find((function(e){return e.size===parseInt(a)}))})):o;if(E)throw E;return s?r.a.createElement(d,null):0===o.length?r.a.createElement(O,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{id:"filters"},r.a.createElement("label",{htmlFor:"size"},"Filter by Size:")," ",r.a.createElement("select",{id:"size",value:a,onChange:function(e){return c(e.target.value)}},r.a.createElement("option",{value:""},"All sizes"),r.a.createElement("option",{value:"7"},"7"),r.a.createElement("option",{value:"8"},"8"),r.a.createElement("option",{value:"9"},"9")),a&&r.a.createElement("h2",null,"Found ",p.length," items")),r.a.createElement("section",{id:"products"},p.map((function(e){return r.a.createElement("div",{key:e.id,className:"product"},r.a.createElement(i.b,{to:"/".concat(l,"/").concat(e.id)},r.a.createElement("img",{src:"/images/".concat(e.image),alt:e.name}),r.a.createElement("h3",null,e.name),r.a.createElement("p",null,"$",e.price)))}))))}var S=a(8),j=a(9),k=a(11),C=a(10),_=a(18),T=a(5);function P(e,t){switch(t.type){case"empty":return[];case"updateQuantity":var a=t.quantity,n=t.sku;return 0===a?e.filter((function(e){return e.sku!==n})):e.map((function(e){return e.sku===n?Object(T.a)(Object(T.a)({},e),{},{quantity:a}):e}));case"add":var r=t.id,c=t.sku;return e.find((function(e){return e.sku===c}))?e.map((function(e){return e.sku===c?Object(T.a)(Object(T.a)({},e),{},{quantity:e.quantity+1}):e})):[].concat(Object(_.a)(e),[{id:r,sku:c,quantity:1}]);default:throw new Error("Unhandled action "+t.type)}}var w,A=r.a.createContext(null);try{var I;w=null!==(I=JSON.parse(localStorage.getItem("cart")))&&void 0!==I?I:[]}catch(Q){console.error("The cart could not be parsed into JSON."),w=[]}function N(e){var t=Object(n.useReducer)(P,w),a=Object(m.a)(t,2),c=a[0],l=a[1];Object(n.useEffect)((function(){return localStorage.setItem("cart",JSON.stringify(c))}),[c]);var u={cart:c,dispatch:l};return r.a.createElement(A.Provider,{value:u},e.children)}function x(){var e=Object(n.useContext)(A);if(!e)throw new Error("useCart must be used within a CartProvider. Wrap a parent component in <CartProvider> to fix this error.");return e}function R(){var e=Object(y.h)().id;return r.a.createElement(D,{id:e,navigate:Object(y.g)()})}var D=function(e){Object(k.a)(a,e);var t=Object(C.a)(a);function a(){var e;Object(S.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={sku:""},e}return Object(j.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.id,n=t.navigate,c=this.state.sku;return r.a.createElement(A.Consumer,null,(function(t){var l=t.dispatch;return r.a.createElement(b,{url:"products/".concat(a)},(function(t,u,i){if(u)return r.a.createElement(d,null);if(!t)return r.a.createElement(O,null);if(i)throw i;return r.a.createElement("div",{id:"detail"},r.a.createElement("h1",null,t.name),r.a.createElement("p",null,t.description),r.a.createElement("p",{id:"price"},"$",t.price),r.a.createElement("select",{id:"size",value:c,onChange:function(t){return e.setState({sku:t.target.value})}},r.a.createElement("option",{value:""},"What size?"),t.skus.map((function(e){return r.a.createElement("option",{key:e.sku,value:e.sku},e.size)}))),r.a.createElement("p",null,r.a.createElement("button",{disabled:!c,className:"btn btn-primary",onClick:function(){l({type:"add",id:a,sku:c}),n("/cart")}},"Add to cart")),r.a.createElement("img",{src:"/images/".concat(t.image),alt:t.category}))}))}))}}]),a}(r.a.Component);function U(){var e=x(),t=e.cart,a=e.dispatch,c=Object(y.g)(),l=function(e){var t=Object(n.useRef)([]),a=Object(n.useState)(null),r=Object(m.a)(a,2),c=r[0],l=r[1],u=Object(n.useState)(!0),i=Object(m.a)(u,2),o=i[0],s=i[1],d=Object(n.useState)(null),E=Object(m.a)(d,2),p=E[0],h=E[1];return Object(n.useEffect)((function(){if(a=t.current,n=e,a.length===n.length&&a.every((function(e,t){return e===n[t]})))s(!1);else{var a,n;t.current=e;var r=e.map((function(e){return fetch(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_BASE_URL+e).then((function(e){if(e.ok)return e.json();throw e}))}));Promise.all(r).then((function(e){return l(e)})).catch((function(e){console.error(e),h(e)})).finally((function(){return s(!1)}))}}),[e]),{data:c,loading:o,error:p}}(t.map((function(e){return"products/".concat(e.id)}))),u=l.data,i=l.loading,o=l.error;if(i)return r.a.createElement(d,null);if(o)throw o;var s=t.reduce((function(e,t){return e+t.quantity}),0);return r.a.createElement("section",{id:"cart"},r.a.createElement("h1",null,0===s?"Your cart is empty":"".concat(s," Item").concat(s>1?"s":""," in My Cart")),r.a.createElement("ul",null,t.map((function(e){var t=e.id,n=e.sku,c=e.quantity,l=u.find((function(e){return e.id===parseInt(t)})),i=l.price,o=l.name,s=l.image,m=l.skus.find((function(e){return e.sku===n})).size;return r.a.createElement("li",{key:n,className:"cart-item"},r.a.createElement("img",{src:"/images/".concat(s),alt:o}),r.a.createElement("div",null,r.a.createElement("h3",null,o),r.a.createElement("p",null,"$",i),r.a.createElement("p",null,"Size: ",m),r.a.createElement("p",null,r.a.createElement("select",{"aria-label":"Select quantity for ".concat(o," size ").concat(m),onChange:function(e){return a({type:"updateQuantity",sku:n,quantity:parseInt(e.target.value)})},value:c},r.a.createElement("option",{value:"0"},"Remove"),r.a.createElement("option",{value:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"4"},"4"),r.a.createElement("option",{value:"5"},"5")))))}))),t.length>0&&r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return c("/checkout")}},"Checkout"))}var B=a(13),W=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_BASE_URL;function q(e){return z.apply(this,arguments)}function z(){return(z=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(W+"shippingAddress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F="IDLE",K="SUBMITTED",L="SUBMITTING",H="COMPLETED",J={city:"",country:""},V=function(e){Object(k.a)(a,e);var t=Object(C.a)(a);function a(){var e;Object(S.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={address:J,status:F,saveError:null,touched:{}},e.handleChange=function(t){t.persist(),e.setState((function(e){return{address:Object(T.a)(Object(T.a)({},e.address),{},Object(B.a)({},t.target.id,t.target.value))}}))},e.handleBlur=function(t){t.persist(),e.setState((function(e){return{touched:Object(T.a)(Object(T.a)({},e.touched),{},Object(B.a)({},t.target.id,!0))}}))},e.handleSubmit=function(){var t=Object(h.a)(p.a.mark((function t(a){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.setState({status:L}),!e.isValid()){t.next=15;break}return t.prev=3,t.next=6,q(e.state.address);case 6:e.props.dispatch({type:"empty"}),e.setState({status:H}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),e.setState({saveError:t.t0});case 13:t.next=16;break;case 15:e.setState({status:K});case 16:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(j.a)(a,[{key:"isValid",value:function(){var e=this.getErrors(this.state.address);return 0===Object.keys(e).length}},{key:"getErrors",value:function(e){var t={};return e.city||(t.city="City is required"),e.country||(t.country="Country is required"),t}},{key:"render",value:function(){var e=this.state,t=e.status,a=e.saveError,n=e.touched,c=e.address,l=this.getErrors(this.state.address);if(a)throw a;return t===H?r.a.createElement("h1",null,"Thanks for shopping!"):r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Shipping Info"),!this.isValid()&&t===K&&r.a.createElement("div",{role:"alert"},r.a.createElement("p",null,"Please fix the following errors:"),r.a.createElement("ul",null,Object.keys(l).map((function(e){return r.a.createElement("li",{key:e},l[e])})))),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"city"},"City"),r.a.createElement("br",null),r.a.createElement("input",{id:"city",type:"text",value:c.city,onBlur:this.handleBlur,onChange:this.handleChange}),r.a.createElement("p",{role:"alert"},(n.city||t===K)&&l.city)),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"country"},"Country"),r.a.createElement("br",null),r.a.createElement("select",{id:"country",value:c.country,onBlur:this.handleBlur,onChange:this.handleChange},r.a.createElement("option",{value:""},"Select Country"),r.a.createElement("option",{value:"China"},"China"),r.a.createElement("option",{value:"India"},"India"),r.a.createElement("option",{value:"United Kingdom"},"United Kingdom"),r.a.createElement("option",{value:"USA"},"USA")),r.a.createElement("p",{role:"alert"},(n.country||t===K)&&l.country)),r.a.createElement("div",null,r.a.createElement("input",{type:"submit",className:"btn btn-primary",value:"Save Shipping Info",disabled:t===L}))))}}]),a}(r.a.Component);function M(){var e=x().dispatch;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"content"},r.a.createElement(s,null),r.a.createElement("main",null,r.a.createElement(y.c,null,r.a.createElement(y.a,{path:"/",element:r.a.createElement("h1",null,"Welcome to Carved Rock Fitness")}),r.a.createElement(y.a,{path:"/:category",element:r.a.createElement(g,null)}),r.a.createElement(y.a,{path:"/:category/:id",element:r.a.createElement(R,null)}),r.a.createElement(y.a,{path:"/cart",element:r.a.createElement(U,null)}),r.a.createElement(y.a,{path:"/checkout",element:r.a.createElement(V,{dispatch:e})})))),r.a.createElement(u,null))}var $=function(e){Object(k.a)(a,e);var t=Object(C.a)(a);function a(e){var n;return Object(S.a)(this,a),(n=t.call(this,e)).state={hasError:!1},n}return Object(j.a)(a,[{key:"render",value:function(){return this.state.hasError?r.a.createElement("h1",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),a}(r.a.Component);l.a.render(r.a.createElement($,null,r.a.createElement(i.a,null,r.a.createElement(N,null,r.a.createElement(M,null)))),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.03cbbb8b.chunk.js.map